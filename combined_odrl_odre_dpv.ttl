# Combined DPV+ODRL+ODRE Ontology
# Integrating Data Privacy Vocabulary, Open Digital Rights Language, and Open Digital Rights Enforcement

@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

# Core Namespaces
@prefix dpv: <https://w3id.org/dpv#> .
@prefix dpv-pd: <https://w3id.org/dpv/dpv-pd#> .
@prefix dpv-tech: <https://w3id.org/dpv/tech#> .
@prefix dpv-legal: <https://w3id.org/dpv/legal/> .
@prefix odrl: <http://www.w3.org/ns/odrl/2/> .
@prefix odre: <https://w3id.org/def/odre#> .

# Combined namespace for integrated ontology
@prefix integrated: <https://w3id.org/def/integrated-dpv-odrl-odre#> .

# ==========================================
# ONTOLOGY DECLARATION
# ==========================================

<https://w3id.org/def/integrated-dpv-odrl-odre> a owl:Ontology ;
    dcterms:title "Integrated DPV+ODRL+ODRE Ontology"@en ;
    dcterms:description "A combined ontology integrating Data Privacy Vocabulary (DPV), Open Digital Rights Language (ODRL), and Open Digital Rights Enforcement (ODRE) for comprehensive privacy rights management and enforcement."@en ;
    dcterms:created "2025-01-01"^^xsd:date ;
    dcterms:creator "Legislation Rules Converter System" ;
    owl:versionInfo "1.0" ;
    owl:imports <https://w3id.org/dpv>, <http://www.w3.org/ns/odrl/2/> .

# ==========================================
# CORE CLASSES
# ==========================================

# ODRE Core Classes
odre:EnforceablePolicy a owl:Class ;
    rdfs:label "Enforceable Policy"@en ;
    rdfs:comment "A policy that can be automatically enforced through technical means"@en ;
    rdfs:subClassOf odrl:Policy, dpv:ProcessingActivity ;
    skos:definition "A digital policy that combines ODRL policy expressions with DPV privacy concepts and includes enforcement mechanisms"@en .

odre:EnforcementFramework a owl:Class ;
    rdfs:label "Enforcement Framework"@en ;
    rdfs:comment "A framework for enforcing digital rights and privacy policies"@en ;
    skos:definition "Technical and organizational infrastructure for monitoring and enforcing policy compliance"@en .

odre:ComplianceCheck a owl:Class ;
    rdfs:label "Compliance Check"@en ;
    rdfs:comment "A mechanism for verifying policy compliance"@en ;
    rdfs:subClassOf dpv:OrganisationalMeasure ;
    skos:definition "Automated or manual process for determining whether actions comply with established policies"@en .

odre:MonitoringActivity a owl:Class ;
    rdfs:label "Monitoring Activity"@en ;
    rdfs:comment "Activity that monitors for policy violations"@en ;
    rdfs:subClassOf dpv:ProcessingActivity ;
    skos:definition "Systematic observation and recording of activities to ensure policy compliance"@en .

# Integrated Classes
integrated:PrivacyRightsPolicy a owl:Class ;
    rdfs:label "Privacy Rights Policy"@en ;
    rdfs:comment "A policy specifically governing privacy rights and data protection"@en ;
    rdfs:subClassOf odre:EnforceablePolicy ;
    skos:definition "Enforceable policy that specifically addresses data subject rights and privacy protection requirements"@en .

integrated:DataProcessingRule a owl:Class ;
    rdfs:label "Data Processing Rule"@en ;
    rdfs:comment "A rule governing specific data processing activities"@en ;
    rdfs:subClassOf odrl:Rule, dpv:ProcessingActivity ;
    skos:definition "Specific constraint or obligation related to the processing of personal data"@en .

integrated:ConsentManagementPolicy a owl:Class ;
    rdfs:label "Consent Management Policy"@en ;
    rdfs:comment "Policy governing consent collection, management, and enforcement"@en ;
    rdfs:subClassOf integrated:PrivacyRightsPolicy ;
    skos:definition "Enforceable policy that manages consent lifecycle and ensures consent-based processing compliance"@en .

# ==========================================
# PROPERTIES - ODRE Extensions
# ==========================================

# Enforcement Properties
odre:enforceable a owl:DatatypeProperty ;
    rdfs:label "enforceable"@en ;
    rdfs:comment "Indicates whether a policy can be automatically enforced"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:boolean ;
    skos:definition "Boolean property indicating if the policy has the necessary technical mechanisms for automatic enforcement"@en .

odre:enforcementMode a owl:DatatypeProperty ;
    rdfs:label "enforcement mode"@en ;
    rdfs:comment "Specifies the mode of policy enforcement"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:string ;
    skos:definition "Describes how the policy is enforced (e.g., real_time, batch, manual, hybrid)"@en .

odre:monitoringRequired a owl:DatatypeProperty ;
    rdfs:label "monitoring required"@en ;
    rdfs:comment "Indicates if monitoring is required for this policy"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:boolean ;
    skos:definition "Boolean indicating whether continuous monitoring is necessary for policy enforcement"@en .

odre:complianceCheck a owl:DatatypeProperty ;
    rdfs:label "compliance check"@en ;
    rdfs:comment "Indicates if compliance checking is enabled"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:boolean ;
    skos:definition "Boolean indicating whether automated compliance verification is active"@en .

odre:temporalEnforcement a owl:DatatypeProperty ;
    rdfs:label "temporal enforcement"@en ;
    rdfs:comment "Indicates if temporal constraints are enforced"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:boolean ;
    skos:definition "Boolean indicating whether time-based constraints are actively monitored and enforced"@en .

odre:hasConfidenceScore a owl:DatatypeProperty ;
    rdfs:label "has confidence score"@en ;
    rdfs:comment "Confidence score for automatically extracted rules"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range xsd:float ;
    skos:definition "Numerical score (0.0-1.0) indicating confidence in the accuracy of automated rule extraction"@en .

# Integration Properties
integrated:hasEnforcementMechanism a owl:ObjectProperty ;
    rdfs:label "has enforcement mechanism"@en ;
    rdfs:comment "Links a policy to its enforcement mechanism"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range odre:EnforcementFramework ;
    skos:definition "Connects an enforceable policy with the technical or organizational mechanisms that implement it"@en .

integrated:triggersComplianceCheck a owl:ObjectProperty ;
    rdfs:label "triggers compliance check"@en ;
    rdfs:comment "Links an action to compliance verification"@en ;
    rdfs:domain dpv:ProcessingActivity ;
    rdfs:range odre:ComplianceCheck ;
    skos:definition "Indicates that a processing activity automatically initiates compliance verification procedures"@en .

integrated:requiresMonitoring a owl:ObjectProperty ;
    rdfs:label "requires monitoring"@en ;
    rdfs:comment "Links a policy to monitoring requirements"@en ;
    rdfs:domain odre:EnforceablePolicy ;
    rdfs:range odre:MonitoringActivity ;
    skos:definition "Specifies that a policy mandates continuous monitoring of related activities"@en .

# ==========================================
# DPV EXTENSIONS AND SPECIALIZATIONS
# ==========================================

# Enhanced Data Categories (extending DPV)
dpv-pd:BiometricIdentificationData a owl:Class ;
    rdfs:label "Biometric Identification Data"@en ;
    rdfs:comment "Biometric data used specifically for identification purposes"@en ;
    rdfs:subClassOf dpv-pd:Biometric ;
    skos:definition "Biometric information processed with the specific purpose of uniquely identifying individuals"@en .

dpv-pd:BehavioralProfileData a owl:Class ;
    rdfs:label "Behavioral Profile Data"@en ;
    rdfs:comment "Data about behavioral patterns and profiles"@en ;
    rdfs:subClassOf dpv-pd:Behavioral ;
    skos:definition "Information derived from analysis of individual behavior patterns over time"@en .

# Enhanced Roles (extending DPV)
dpv:JointDataControllers a owl:Class ;
    rdfs:label "Joint Data Controllers"@en ;
    rdfs:comment "Multiple controllers jointly determining purposes and means"@en ;
    rdfs:subClassOf dpv:DataController ;
    skos:definition "Two or more controllers that jointly determine the purposes and means of processing"@en .

# Enhanced Technical Measures
dpv-tech:AdvancedEncryption a owl:Class ;
    rdfs:label "Advanced Encryption"@en ;
    rdfs:comment "State-of-the-art encryption methods"@en ;
    rdfs:subClassOf dpv-tech:Encryption ;
    skos:definition "Encryption using current industry-standard advanced cryptographic algorithms"@en .

dpv-tech:ZeroKnowledgeProof a owl:Class ;
    rdfs:label "Zero Knowledge Proof"@en ;
    rdfs:comment "Cryptographic method proving knowledge without revealing the knowledge"@en ;
    rdfs:subClassOf dpv-tech:CryptographicMethods ;
    skos:definition "Cryptographic technique that allows one party to prove knowledge of information without revealing that information"@en .

# ==========================================
# ODRL EXTENSIONS
# ==========================================

# Enhanced Actions
odrl:Monitor a owl:NamedIndividual, odrl:Action ;
    rdfs:label "Monitor"@en ;
    skos:definition "The act of observing or checking the progress of activities"@en .

odrl:Audit a owl:NamedIndividual, odrl:Action ;
    rdfs:label "Audit"@en ;
    skos:definition "The act of conducting a systematic review or assessment"@en .

odrl:Anonymize a owl:NamedIndividual, odrl:Action ;
    rdfs:label "Anonymize"@en ;
    skos:definition "The act of removing personally identifiable information"@en .

odrl:Pseudonymize a owl:NamedIndividual, odrl:Action ;
    rdfs:label "Pseudonymize"@en ;
    skos:definition "The act of replacing identifying information with pseudonyms"@en .

# Enhanced Constraints
odrl:dataCategory a owl:NamedIndividual, odrl:LeftOperand ;
    rdfs:label "Data Category"@en ;
    skos:definition "The category or type of data being processed"@en .

odrl:processingPurpose a owl:NamedIndividual, odrl:LeftOperand ;
    rdfs:label "Processing Purpose"@en ;
    skos:definition "The specific purpose for which data is being processed"@en .

odrl:dataSubjectRole a owl:NamedIndividual, odrl:LeftOperand ;
    rdfs:label "Data Subject Role"@en ;
    skos:definition "The role or relationship of the data subject to the processing"@en .

odrl:retentionPeriod a owl:NamedIndividual, odrl:LeftOperand ;
    rdfs:label "Retention Period"@en ;
    skos:definition "The duration for which data may be retained"@en .

# ==========================================
# INTEGRATED CONCEPTS
# ==========================================

# Compliance Levels
integrated:FullCompliance a owl:NamedIndividual ;
    rdfs:label "Full Compliance"@en ;
    skos:definition "Complete adherence to all policy requirements"@en .

integrated:PartialCompliance a owl:NamedIndividual ;
    rdfs:label "Partial Compliance"@en ;
    skos:definition "Adherence to some but not all policy requirements"@en .

integrated:NonCompliance a owl:NamedIndividual ;
    rdfs:label "Non Compliance"@en ;
    skos:definition "Failure to meet policy requirements"@en .

# Enforcement States
integrated:ActiveEnforcement a owl:NamedIndividual ;
    rdfs:label "Active Enforcement"@en ;
    skos:definition "Policy enforcement is currently active and operational"@en .

integrated:SuspendedEnforcement a owl:NamedIndividual ;
    rdfs:label "Suspended Enforcement"@en ;
    skos:definition "Policy enforcement is temporarily suspended"@en .

integrated:InactiveEnforcement a owl:NamedIndividual ;
    rdfs:label "Inactive Enforcement"@en ;
    skos:definition "Policy enforcement is not currently operational"@en .

# ==========================================
# EXAMPLE INDIVIDUALS
# ==========================================

# Example Enforceable Policy
integrated:GDPRArticle28Policy a odre:EnforceablePolicy ;
    rdfs:label "GDPR Article 28 Processor Policy"@en ;
    dcterms:description "Enforceable policy based on GDPR Article 28 processor requirements"@en ;
    odre:enforceable true ;
    odre:enforcementMode "real_time" ;
    odre:monitoringRequired true ;
    odre:complianceCheck true ;
    odre:temporalEnforcement false ;
    odre:hasConfidenceScore "0.95"^^xsd:float ;
    dpv:hasProcessing dpv:Store, dpv:Use ;
    dpv:hasPurpose dpv:ServiceProvision ;
    dpv:hasPersonalData dpv:PersonalData ;
    dpv:hasDataController dpv:DataController ;
    dpv:hasDataProcessor dpv:DataProcessor ;
    dpv:hasLegalBasis dpv:Contract .

# Example Data Processing Rule
integrated:ProcessorAuthorizationRule a integrated:DataProcessingRule ;
    rdfs:label "Processor Authorization Rule"@en ;
    dcterms:description "Rule requiring explicit authorization before engaging sub-processors"@en ;
    odrl:action odrl:Use ;
    odrl:constraint [
        odrl:leftOperand odrl:recipient ;
        odrl:operator odrl:eq ;
        odrl:rightOperand "authorized_processor"
    ] ;
    odrl:duty [
        odrl:action odrl:obtainConsent ;
        odrl:constraint [
            odrl:leftOperand odrl:event ;
            odrl:operator odrl:lt ;
            odrl:rightOperand "processing_start"
        ]
    ] .